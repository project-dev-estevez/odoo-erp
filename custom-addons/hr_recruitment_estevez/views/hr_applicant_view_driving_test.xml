<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_hr_applicant_form_inherit" model="ir.ui.view">
        <field name="name">hr.applicant.form.inherit</field>
        <field name="model">hr.applicant</field>
        <field name="inherit_id" ref="hr_recruitment.hr_applicant_view_form"/>
        <field name="arch" type="xml">
            <!-- Cuando el candidato estÃ¡ en la etapa de "Prueba de Manejo", le mostramos este tab -->
            <xpath expr="//notebook" position="inside">
                <page string="Prueba de Manejo" name="driving_test" invisible="not is_driving_test">
                    
                    <!-- âœ… Banner informativo cuando es solo lectura -->
                    <div class="alert alert-info" role="alert" invisible="is_driving_test_editable">
                        <strong>ðŸ“‹ InformaciÃ³n:</strong> Esta secciÃ³n es de solo lectura. 
                        Para editar, el candidato debe estar en la etapa "Prueba de Manejo".
                    </div>

                    <!-- âœ… BotÃ³n para enviar entrevista teÃ³rica -->
                    <div class="text-center mb-3" invisible="not is_driving_test">
                        <button name="action_send_theoretical_interview" 
                                string="ðŸ“ Enviar Entrevista TeÃ³rica" 
                                type="object" 
                                class="btn btn-success"
                                help="EnvÃ­a la evaluaciÃ³n teÃ³rica de prueba de manejo al candidato"/>
                    </div>

                    <group string="InformaciÃ³n del Evaluador">
                        <group>
                            <field name="evaluator_id" readonly="not is_driving_test_editable"/>
                            <field name="evaluator_job_title" readonly="1"/>
                        </group>
                    </group>

                    <group string="InformaciÃ³n de la Licencia">
                        <group>
                            <field name="license_type" readonly="not is_driving_test_editable"/>
                            <field name="license_number" readonly="not is_driving_test_editable"/>
                            <field name="unit_number" readonly="not is_driving_test_editable"/>
                        </group>
                        <group>
                            <!-- âœ… Campo dinÃ¡mico que se muestra cuando se selecciona un tipo -->
                            <field name="license_description"
                                readonly="1"
                                invisible="not license_type"
                                nolabel="1"/>
                        </group>
                    </group>

                    <!-- âœ… SECCIÃ“N 1: CONOCIMIENTO, INSPECCIÃ“N Y ADAPTACIÃ“N -->
                    <group string="1. CONOCIMIENTO, INSPECCIÃ“N Y ADAPTACIÃ“N DEL VEHÃCULO">
                        <group>
                            <field name="fluid_levels_inspection"
                                readonly="not is_driving_test_editable" />
                            <field name="battery_inspection" readonly="not is_driving_test_editable" />
                            <field name="tire_verification" readonly="not is_driving_test_editable" />
                        </group>
                        <group>
                            <field name="safety_adaptation" readonly="not is_driving_test_editable" />
                            <field name="lights_verification"
                                readonly="not is_driving_test_editable" />
                            <field name="knowledge_average" readonly="1" widget="float" />
                        </group>
                    </group>

                    <!-- âœ… SECCIÃ“N 2: DESTREZA Y HABILIDADES -->
                    <group string="2. DESTREZA Y HABILIDADES EN EL MANEJO">
                        <group>
                            <field name="ignition_maneuver" readonly="not is_driving_test_editable" />
                            <field name="starting_movement" readonly="not is_driving_test_editable" />
                            <field name="straight_line_advance"
                                readonly="not is_driving_test_editable" />
                            <field name="maneuver_coordination"
                                readonly="not is_driving_test_editable" />
                            <field name="gear_application" readonly="not is_driving_test_editable" />
                        </group>
                        <group>
                            <field name="inclined_terrain" readonly="not is_driving_test_editable" />
                            <field name="circulation_overtaking"
                                readonly="not is_driving_test_editable" />
                            <field name="clutch_application" readonly="not is_driving_test_editable" />
                            <field name="brake_parking" readonly="not is_driving_test_editable" />
                            <field name="parking_entry" readonly="not is_driving_test_editable" />
                            <field name="skills_average" readonly="1" widget="float" />
                        </group>
                    </group>

                    <!-- âœ… SECCIÃ“N 3: COMPORTAMIENTO EN TRÃNSITO -->
                    <group string="3. COMPORTAMIENTO DEL CONDUCTOR FRENTE AL TRÃNSITO">
                        <group>
                            <field name="regulation_employment"
                                readonly="not is_driving_test_editable" />
                            <field name="following_distance" readonly="not is_driving_test_editable" />
                            <field name="lane_changes" readonly="not is_driving_test_editable" />
                        </group>
                        <group>
                            <field name="lane_use" readonly="not is_driving_test_editable" />
                            <field name="directional_handling"
                                readonly="not is_driving_test_editable" />
                            <field name="behavior_average" readonly="1" widget="float" />
                        </group>
                    </group>

                    <!-- âœ… RESULTADO FINAL -->
                    <group string="Resultado Final de la EvaluaciÃ³n">
                        <group>
                            <field name="theoretical_exam_result" readonly="not is_driving_test_editable"/>
                            <field name="practical_exam_result" readonly="1" widget="float" />
                        </group>
                        <group>
                            <field name="final_test_average" readonly="1" widget="float" />
                            <field name="final_test_result" readonly="1" />
                        </group>
                    </group>

                    <!-- âœ… BotÃ³n solo visible cuando es editable -->
                    <div class="text-center mt-3" invisible="not is_driving_test_editable">
                        <button name="action_save_driving_test" 
                                string="Guardar InformaciÃ³n" 
                                type="object" 
                                class="btn btn-primary"/>
                    </div>

                </page>
            </xpath>    
        </field>
    </record> 

</odoo>
