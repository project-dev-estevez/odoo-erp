<odoo>
    <template id="hr_applicant_driving_test_report_document">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="applicant">
                <t t-call="web.external_layout">

                    <!-- Titulo y Fecha -->
                    <div class="row align-items-center">
                        <div class="col text-center">
                            <h2 class="mb-0 fw-bold fs-3">PRUEBA DE MANEJO</h2>
                        </div>

                        <div class="col-auto text-end">
                            <span class="fw-bold">FECHA:</span>
                            <span class="fw-bold">
                                <t t-esc="applicant.create_date.strftime('%d/%m/%Y')" />
                            </span>
                        </div>
                    </div>

                    <!-- Información principal, Aviso y Escala de Evaluación -->
                    <table class="table table-sm table-borderless align-middle" style="font-size: 11px;">
                        <tbody>
                            <tr>
                                <td colspan="6" class="col-8">
                                    <strong>NOMBRE DEL EVALUADOR:</strong>
                                    <span t-field="applicant.evaluator_id.name" />
                                </td>
                                <td colspan="6" class="col-4">
                                    <strong>TIPO DE LICENCIA:</strong>
                                    <span t-field="applicant.license_type" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="6" class="col-8">
                                    <strong>NOMBRE DEL APLICANTE:</strong>
                                    <span t-field="applicant.partner_name" />
                                </td>
                                <td colspan="6" class="col-4">
                                    <strong>No DE LICENCIA:</strong>
                                    <span t-field="applicant.license_number" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="6" class="col-8 text-warning">
                                    <strong>En caso de daños al vehículo o infracciones de tránsito durante la prueba, los costos serán asumidos por el aplicante</strong>
                                </td>
                                <td colspan="6" class="col-4">
                                    <strong>UNIDAD:</strong>
                                    <span t-field="applicant.unit_number" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" class="text-center fw-bold">RANGO EVALUACIÓN:</td>
                                <td colspan="2" class="text-center fw-bold">5 - EXCELENTE</td>
                                <td colspan="2" class="text-center fw-bold">4 - BUENO</td>
                                <td colspan="2" class="text-center fw-bold">3 - REGULAR</td>
                                <td colspan="2" class="text-center fw-bold">2 - MALO</td>
                                <td colspan="2" class="text-center fw-bold">1 - DEFICIENTE</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Tabla Unificada de Evaluación -->
                    <table class="table table-sm table-borderless align-middle" style="font-size: 11px;">
                        <thead>
                            <tr>
                                <th class="col-3 text-center">ASPECTOS DE EVALUACIÓN</th>
                                <th class="col-7 text-center">FACTOR EVALUADO</th>
                                <th class="col-2 text-center">EV</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- SECCIÓN 1: CONOCIMIENTO, INSPECCIÓN Y ADAPTACIÓN DEL VEHÍCULO -->
                            <tr>
                                <td rowspan="6" class="text-center align-top fw-bold">
                                    CONOCIMIENTO, INSPECCIÓN Y ADAPTACIÓN DEL VEHÍCULO
                                </td>
                                <td>Inspección de los niveles (refrigerante, líquido de frenos, aceite)</td>
                                <td class="text-center"><span t-field="applicant.fluid_levels_inspection" /></td>
                            </tr>
                            <tr>
                                <td>Inspección de estado físico de la batería</td>
                                <td class="text-center"><span t-field="applicant.battery_inspection" /></td>
                            </tr>
                            <tr>
                                <td>Verificación estado de llantas (estado y presión)</td>
                                <td class="text-center"><span t-field="applicant.tire_verification" /></td>
                            </tr>
                            <tr>
                                <td>Adaptación o graduación del cinturón de seguridad, espejos laterales, asiento y retrovisor</td>
                                <td class="text-center"><span t-field="applicant.safety_adaptation" /></td>
                            </tr>
                            <tr>
                                <td>Verificación del estado de las luces (altas, bajas, direccionales, freno de parqueo)</td>
                                <td class="text-center"><span t-field="applicant.lights_verification" /></td>
                            </tr>
                            <!-- Promedio Sección 1 -->
                            <tr>
                                <td class="fw-bold text-end">RESULTADOS:</td>
                                <td class="text-center">
                                    <div class="row">
                                        <div class="col-6">
                                            <small class="fw-bold">Suma:</small>
                                            <span class="badge text-info text-dark fw-bold"><t t-esc="applicant.knowledge_sum" /></span>
                                        </div>
                                        <div class="col-6">
                                            <small class="fw-bold">Prom:</small>
                                            <t t-if="applicant.knowledge_average >= 8">
                                                <span class="badge text-success fw-bold"><t t-esc="applicant.knowledge_average" /></span>
                                            </t>
                                            <t t-elif="applicant.knowledge_average >= 6">
                                                <span class="badge text-warning fw-bold"><t t-esc="applicant.knowledge_average" /></span>
                                            </t>
                                            <t t-else="">
                                                <span class="badge text-danger fw-bold"><t t-esc="applicant.knowledge_average" /></span>
                                            </t>
                                        </div>
                                    </div>
                                </td>
                            </tr>

                            <!-- SECCIÓN 2: DESTREZA Y HABILIDADES -->
                            <tr>
                                <td rowspan="11" class="text-center align-top fw-bold">
                                    DESTREZA Y HABILIDADES EN EL MANEJO DE LOS MECANISMOS DE CONTROL Y LA CONDUCCIÓN DEL VEHÍCULO
                                </td>
                                <td>Maniobra de encendido y arranque del vehículo</td>
                                <td class="text-center"><span t-field="applicant.ignition_maneuver" /></td>
                            </tr>
                            <tr>
                                <td>Puesta en marcha en plano y en pendiente</td>
                                <td class="text-center"><span t-field="applicant.starting_movement" /></td>
                            </tr>
                            <tr>
                                <td>Avance en línea recta y con ángulos</td>
                                <td class="text-center"><span t-field="applicant.straight_line_advance" /></td>
                            </tr>
                            <tr>
                                <td>Coordinación de maniobras aceleración, freno, cambio y embrague</td>
                                <td class="text-center"><span t-field="applicant.maneuver_coordination" /></td>
                            </tr>
                            <tr>
                                <td>Aplicación de cambios ascendentes y descendentes</td>
                                <td class="text-center"><span t-field="applicant.gear_application" /></td>
                            </tr>
                            <tr>
                                <td>Descenso y ascenso en terreno inclinado</td>
                                <td class="text-center"><span t-field="applicant.inclined_terrain" /></td>
                            </tr>
                            <tr>
                                <td>Maniobra de circulación y adelantamiento</td>
                                <td class="text-center"><span t-field="applicant.circulation_overtaking" /></td>
                            </tr>
                            <tr>
                                <td>Aplicación del embrague</td>
                                <td class="text-center"><span t-field="applicant.clutch_application" /></td>
                            </tr>
                            <tr>
                                <td>Aplicación de frenos y parqueo en reversa</td>
                                <td class="text-center"><span t-field="applicant.brake_parking" /></td>
                            </tr>
                            <tr>
                                <td>Ingreso al área de parqueo en reversa</td>
                                <td class="text-center"><span t-field="applicant.parking_entry" /></td>
                            </tr>
                            <!-- Promedio Sección 2 -->
                            <tr>
                                <td class="fw-bold text-end">RESULTADOS:</td>
                                <td class="text-center">
                                    <div class="row">
                                        <div class="col-6">
                                            <small class="fw-bold">Suma:</small>
                                            <span class="badge text-info text-dark fw-bold"><t t-esc="applicant.skills_sum" /></span>
                                        </div>
                                        <div class="col-6">
                                            <small class="fw-bold">Prom:</small>
                                            <t t-if="applicant.skills_average >= 56">
                                                <span class="badge text-success fw-bold"><t t-esc="applicant.skills_average" /></span>
                                            </t>
                                            <t t-elif="applicant.skills_average >= 42">
                                                <span class="badge text-warning fw-bold"><t t-esc="applicant.skills_average" /></span>
                                            </t>
                                            <t t-else="">
                                                <span class="badge text-danger fw-bold"><t t-esc="applicant.skills_average" /></span>
                                            </t>
                                        </div>
                                    </div>
                                </td>
                            </tr>

                            <!-- SECCIÓN 3: COMPORTAMIENTO DEL CONDUCTOR -->
                            <tr>
                                <td rowspan="6" class="text-center align-top fw-bold">
                                    COMPORTAMIENTO DEL CONDUCTOR FRENTE AL TRÁNSITO, RESPETO POR LAS SEÑALES DE TRÁNSITO, POR EL PEATÓN, USO ADECUADO DE LA INFRAESTRUCTURA
                                </td>
                                <td>Empleo del reglamento de tránsito (señalizaciones y límites de velocidad)</td>
                                <td class="text-center"><span t-field="applicant.regulation_employment" /></td>
                            </tr>
                            <tr>
                                <td>Distancia de seguimiento de parada y lateral</td>
                                <td class="text-center"><span t-field="applicant.following_distance" /></td>
                            </tr>
                            <tr>
                                <td>Cambios de carril, de calzada y adelantamientos</td>
                                <td class="text-center"><span t-field="applicant.lane_changes" /></td>
                            </tr>
                            <tr>
                                <td>Uso adecuado de cambio de carriles</td>
                                <td class="text-center"><span t-field="applicant.lane_use" /></td>
                            </tr>
                            <tr>
                                <td>Manejo adecuado de las luces direccionales</td>
                                <td class="text-center"><span t-field="applicant.directional_handling" /></td>
                            </tr>
                            <!-- Promedio Sección 3 -->
                            <tr>
                                <td class="fw-bold text-end">RESULTADOS:</td>
                                <td class="text-center">
                                    <div class="row">
                                        <div class="col-6">
                                            <small class="fw-bold">Suma:</small>
                                            <span class="badge text-info text-dark fw-bold"><t t-esc="applicant.behavior_sum" /></span>
                                        </div>
                                        <div class="col-6">
                                            <small class="fw-bold">Prom:</small>
                                            <t t-if="applicant.behavior_average >= 16">
                                                <span class="badge text-success fw-bold"><t t-esc="applicant.behavior_average" /></span>
                                            </t>
                                            <t t-elif="applicant.behavior_average >= 12">
                                                <span class="badge text-warning fw-bold"><t t-esc="applicant.behavior_average" /></span>
                                            </t>
                                            <t t-else="">
                                                <span class="badge text-danger fw-bold"><t t-esc="applicant.behavior_average" /></span>
                                            </t>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Resultados de examen -->
                    <table class="table table-sm table-borderless align-middle mb-0" style="font-size: 11px;">
                        <tbody>
                            <tr>
                            <td class="col-8">
                                <strong>RESULTADO EXAMEN TEÓRICO: 10% = </strong>
                                <t t-if="applicant.theoretical_exam_result_10 >= 7">
                                    <span class="badge text-success fw-bold"><t t-esc="applicant.theoretical_exam_result_10" />%</span>
                                </t>
                                <t t-elif="applicant.theoretical_exam_result_10 >= 4.5">
                                    <span class="badge text-warning fw-bold"><t t-esc="applicant.theoretical_exam_result_10" />%</span>
                                </t>
                                <t t-else="">
                                    <span class="badge text-danger fw-bold"><t t-esc="applicant.theoretical_exam_result_10" />%</span>
                                </t>
                            </td>
                            <td class="col-4 text-center fw-bold align-middle" rowspan="2">
                                CALIFICACIONES MENORES AL 70% DE LA EVALUACIÓN SERÁN REPROBATORIAS
                            </td>
                            </tr>
                            <tr>
                            <td>
                                <strong>RESULTADO EXAMEN PRÁCTICO: 90% = </strong>
                                <t t-if="applicant.practical_exam_result >= 70">
                                    <span class="badge text-success fw-bold"><t t-esc="applicant.practical_exam_result" />%</span>
                                </t>
                                <t t-elif="applicant.practical_exam_result >= 45">
                                    <span class="badge text-warning fw-bold"><t t-esc="applicant.practical_exam_result" />%</span>
                                </t>
                                <t t-else="">
                                    <span class="badge text-danger fw-bold"><t t-esc="applicant.practical_exam_result" />%</span>
                                </t>
                            </td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Observaciones y promedio -->
                    <table class="table table-sm table-borderless align-middle mb-0 mt-2" style="font-size: 11px;">
                        <tbody>
                            <tr>
                            <td class="col-8">
                                <strong>OBSERVACIONES: </strong>
                                <t t-if="applicant.final_test_average >= 70">
                                    <span class="badge text-success fw-bold">APROBADO</span>
                                </t>
                                <t t-else="">
                                    <span class="badge text-danger fw-bold">REPROBADO</span>
                                </t>
                            </td>
                            <td class="col-2 text-center fw-bold">
                                RESULTADO FINAL
                            </td>
                            <td class="col-2 text-center">
                                <t t-if="applicant.final_test_average >= 70">
                                    <span class="badge text-success fw-bold"><t t-esc="applicant.final_test_average" />%</span>
                                </t>
                                <t t-elif="applicant.final_test_average >= 50">
                                    <span class="badge text-warning fw-bold"><t t-esc="applicant.final_test_average" />%</span>
                                </t>
                                <t t-else="">
                                    <span class="badge text-danger fw-bold"><t t-esc="applicant.final_test_average" />%</span>
                                </t>
                            </td>
                            </tr>
                        </tbody>
                    </table>
                </t>
            </t>
        </t>
    </template>
</odoo>